<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rick and Morty Character Search</title>
    <link rel="stylesheet" href="test.css">
</head>
<body>
    <h1>Rick and Morty Character Search</h1>
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Enter character name">
        <button onclick="searchCharacters()">Search</button>
    </div>

    <div id="results" class="results">
        <!-- Resultados de búsqueda se mostrarán aquí -->
    </div>

    <script>
        let page = 1;

        function searchCharacters() {
            const searchQuery = document.getElementById('searchInput').value.trim();

            fetch(`https://rickandmortyapi.com/api/character/?name=${searchQuery}&page=${page}`)
                .then(response => response.json())
                .then(data => displayResults(data));
        }

        function displayResults(data) {
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = '';

            data.results.forEach(character => {
                const characterDiv = document.createElement('div');
                characterDiv.classList.add('character');
                characterDiv.innerHTML = `
                    <h2>${character.name}</h2>
                    <p class="status">${highlightStatus(character.status)}</p>
                    <p>Episode: ${getFirstEpisode(character.episode)}</p>
                    <img src="${character.image}" alt="${character.name}">
                `;
                if (character.origin) {
                    characterDiv.innerHTML += `<p>Origin: ${character.origin.name}</p>`;
                }
                resultsContainer.appendChild(characterDiv);
            });

            // Pagination
            const pagination = document.createElement('div');
            if (data.info.prev) {
                pagination.innerHTML += `<button onclick="previousPage()">Previous</button>`;
            }
            if (data.info.next) {
                pagination.innerHTML += `<button onclick="nextPage()">Next</button>`;
            }
            resultsContainer.appendChild(pagination);
        }

        function highlightStatus(status) {
            if (status === 'Alive') {
                return `<span class="status-alive">${status}</span>`;
            } else if (status === 'Dead') {
                return `<span class="status-dead">${status}</span>`;
            } else {
                return `<span class="status-unknown">Unknown</span>`;
            }
        }

        function getFirstEpisode(episodeList) {
            if (episodeList.length > 0) {
                const episodeUrl = episodeList[0];
                return getEpisodeNumber(episodeUrl);
            } else {
                return 'Unknown';
            }
        }

        function getEpisodeNumber(episodeUrl) {
            return episodeUrl.split('/').pop(); // Obtiene el último segmento de la URL (número de episodio)
        }

        function nextPage() {
            page++;
            searchCharacters();
        }

        function previousPage() {
            page--;
            searchCharacters();
        }

        // Mostrar personajes al cargar la página
        window.onload = function() {
            searchCharacters();
        };
    </script>
</body>
</html>
